
@{
    ViewData["Title"] = "Index";
}

<input type="file" id="imageUpload" onchange="uploadImg();" />

<script>
    function uploadImg() {
        var formData = new FormData();
        var data = document.getElementById('imageUpload');
        formData.append('base64image', data.files[0]);
        addingRoom = true;
        $('#ConfirmButton').attr('class', 'btn btn-primary disabled');
        $('#ConfirmButton').html('<i class="fas fa-spinner fa-spin"></i>');
        $.ajax({
            type: 'POST',
            url: '/Api/Recognizer/UploadImage',
            data: formData,
            processData: false,
            contentType: false,
            async: false,
            success: function (data) {
                linkImg(data.url);
            },
            error: function (data) {
            }
        });
    }

    function linkImg(url) {
        $.ajax({
            url: '/Api/Class/AddPhoto',
            type: 'POST',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            data: JSON.stringify({ 'RecognizerId': '692A545E-C2D2-4D0A-940A-78EDE88BF7CD', 'RecognizerKey': 'E45FE797-8757-4CC5-9D4D-170946F5A2C6', 'classId': '62613087-9c91-4b48-82c3-041376819d3a', 'ImageUrl': url }),
            success: function (data) {
            },
            error: function (data) {
            }
        });
    }
</script>